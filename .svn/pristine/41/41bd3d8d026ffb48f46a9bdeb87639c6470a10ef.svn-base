<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>    
<%@ taglib uri="http://www.springframework.org/security/tags" prefix="security" %> 
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %> 
<security:authentication property="principal.realUser" var="realUser"/> <!-- Provider 시큐리티 정보 -->
<title>${realUser.companyNo } - 메인페이지</title>

<!-- 위젯 컨테이너 -->
<div class="container mt-3">
  <div id="widgetContainer" class="row">
    
    <!-- 위젯 1: 근태 -->
    <div class="col-md-4 widget-box" data-widget-id="dclz">
      <div class="card card-widget">
        <div class="card-body">
          <div class="dclz-summary">
            <c:import url="/${companyNo}/dclz/main-panel" />
          </div>
        </div>
      </div>
    </div>

    <!-- 위젯 2: 일정 -->
<!--     <div class="col-md-4 widget-box" data-widget-id="schedule"> -->
<%--         <c:import url="/${companyNo}/widget/schedule" /> --%>
<!-- 	</div> -->
	<!-- 위젯 3: 공지사항 -->
	<div class="col-md-4 widget-box" data-widget-id="notice">
	  <div class="card card-widget">
	    <div class="card-body">
	      <h4 class="card-title fw-bold">공지사항</h4>
	      <ul class="list-group list-group-flush">
	        <c:forEach var="notice" items="${noticeList}">
	          <li class="list-group-item">
	            <a href="<c:url value='/${companyNo}/notice/${notice.noticeNo}'/>">
	              ${notice.noticeTitle}
	            </a>
	            <br/>
	            <small class="text-muted">${notice.empNm} · ${fn:substring(notice.noticeCreatedAt, 0, 10)}</small>
	          </li>
	        </c:forEach>
	      </ul>
	      <a href="<c:url value='/${companyNo}/notice'/>" class="btn btn-sm btn-outline-primary mt-2">전체보기</a>
	    </div>
	  </div>
	</div>
    <!-- 필요 시 여기에 위젯을 더 추가 -->
    
  </div>
</div>

<script>
	const contextPath = "${pageContext.request.contextPath}";
	const companyNo = "${companyNo}";
	const empId = "${realUser.empId}";
	
	// 드래그 정렬 활성화
	  new Sortable(document.getElementById('widgetContainer'), {
	    animation: 150,
	    ghostClass: 'sortable-ghost'
	  });
</script>

<script src="${pageContext.request.contextPath }/resources/groupware/js/indexGW.js"></script>
<script src="${pageContext.request.contextPath }/resources/groupware/js/alarm/alarm.js"></script>
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js'></script>
<script src="https://cdn.jsdelivr.net/npm/@fullcalendar/interaction@6.1.15/index.global.min.js"></script>