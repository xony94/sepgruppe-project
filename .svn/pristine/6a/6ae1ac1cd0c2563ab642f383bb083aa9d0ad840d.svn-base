<!-- 
 * == 개정이력(Modification Information) ==
 *   
 *   수정일      			수정자           수정내용
 *  ============   	============== =======================
 *  2025. 3. 27.     	KKM            최초 생성
 *
-->
<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %>
    <title>일감 등록</title>
    <div class="container">
        <h1>일감 등록</h1>
        <form action="${pageContext.request.contextPath}/${companyNo}/task/new" method="post" enctype="multipart/form-data">
            <input type="hidden" id="companyNo" value="${companyNo}" />
            <input type="hidden" id="contextPath" value="${pageContext.request.contextPath}" />

            <c:if test="${not empty selectedProjectNo}">
			    <div class="form-group">
			        <label>프로젝트</label>
			        <input type="text" class="form-control" value="${selectedProjectTitle}" readonly />
			        <input type="hidden" name="projectNo" value="${selectedProjectNo}" />
			    </div>
			</c:if>
			
			<c:if test="${empty selectedProjectNo}">
			    <div class="form-group">
			        <label for="projectNo">프로젝트 선택</label>
			        <select id="projectNo" name="projectNo" class="form-control" required>
			            <option value="">선택하세요</option>
			            <c:forEach var="project" items="${projects}">
			                <option value="${project.projectNo}">${project.projectTitle}</option>
			            </c:forEach>
			        </select>
			    </div>
			</c:if>

            <div class="form-group">
                <label for="taskTitle">업무 제목</label>
                <input type="text" id="taskTitle" name="taskTitle" class="form-control" required />
            </div>

            <div class="form-group">
                <label for="taskContent">업무 내용</label>
                <textarea id="taskContent" name="taskContent" class="form-control" rows="5" required></textarea>
            </div>

            <div class="form-group">
                <label for="taskStartDate">업무 시작일자</label>
                <input type="date" id="taskStartDate" name="taskStartDate" class="form-control" required />
            </div>

            <div class="form-group">
                <label for="taskEndDate">업무 마감일자</label>
                <input type="date" id="taskEndDate" name="taskEndDate" class="form-control" required />
            </div>

            <div class="form-group">
                <label for="priority">우선순위</label>
                <select id="priority" name="priority" class="form-control">
                    <option value="낮음">낮음</option>
                    <option value="보통">보통</option>
                    <option value="높음">높음</option>
                    <option value="긴급">긴급</option>
                    <option value="즉시">즉시</option>
                </select>
            </div>
            
            <div class="form-group">
			    <label for="progress">진척도 (%)</label>
			    <select id="progress" name="progress" class="form-control" required>
			        <c:forEach begin="0" end="100" step="10" var="p">
			            <option value="${p}">${p}%</option>
			        </c:forEach>
			    </select>
			</div>

            <div class="form-group">
                <label for="empId">참여자 선택</label>
                <select id="empId" name="empId" class="form-control" required>
                    <option value="">선택하세요</option>
                    <c:forEach var="participant" items="${participants}">
                        <option value="${participant.empId}">${participant.empId} (${participant.empNm})</option>
                    </c:forEach>
                </select>
            </div>
			
			<div class="form-group">
			    <label for="fileUpload">첨부 파일</label>
			    <input type="file" id="fileUpload" name="uploadFiles" class="form-control" multiple>
			</div>

            <button type="submit" class="btn btn-success">등록</button>
            <a href="${pageContext.request.contextPath}/${companyNo}/task" class="btn btn-secondary">취소</a>
        </form>
    </div>
<script src="${pageContext.request.contextPath }/resources/groupware/js/task/taskForm.js"></script>