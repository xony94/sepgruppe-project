<!-- 
 * == ê°œì •ì´ë ¥(Modification Information) ==
 *   
 *   ìˆ˜ì •ì¼      			ìˆ˜ì •ì           ìˆ˜ì •ë‚´ìš©
 *  ============   	============== =======================
 *  2025. 4. 14.     	JSW            ìµœì´ˆ ìƒì„±
 *
-->
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %>

<div class="card-body">
  <h4 class="card-title">ê²°ì¬ ëŒ€ê¸° ë¬¸ì„œ</h4>
  <table class="table table-sm">
    <thead>
      <tr>
        <th>ê¸°ì•ˆì¼</th>
        <th>ì–‘ì‹</th>
        <th>ê¸´ê¸‰</th>
        <th>ì œëª©</th>
        <th>ê¸°ì•ˆì</th>
        <th>ìƒíƒœ</th>
      </tr>
    </thead>
    <tbody>
      <c:choose>
        <c:when test="${empty waitingDocs}">
          <tr><td colspan="6" class="text-center">ê²°ì¬í•  ë¬¸ì„œê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>
        </c:when>
        <c:otherwise>
          <c:forEach var="doc" items="${waitingDocs}">
            <tr class="waitingDocRow" data-doc-no="${doc.aprvlDocNo}" data-doc-type="${doc.docFrmName}">
              <td>${fn:substring(doc.submitDate, 0, 10)}</td>
              <td>${doc.docFrmName}</td>
              <td>${doc.isEmergency}</td>
              <td>${doc.aprvlDocTitle}</td>
              <td>${doc.drafterName}</td>
              <td><span class="badge" style="background-color: ${doc.statusColor}; color: white;">${doc.statusName}</span></td>
            </tr>
          </c:forEach>
        </c:otherwise>
      </c:choose>
    </tbody>
  </table>
</div>
<script>
document.addEventListener("DOMContentLoaded", function () {
document.querySelectorAll(".waitingDocRow").forEach(row => {
	  row.addEventListener("click", () => {
	  	const docNo = row.getAttribute("data-doc-no");
	    const docType = row.getAttribute("data-doc-type");
	    const encodedDocType = encodeURIComponent(docType);
	    const contextPath = "${pageContext.request.contextPath}";
	    
	    console.log("ğŸ§¾ í´ë¦­ë¨");
	      console.log("ğŸ“„ docNo:", docNo);
	      console.log("ğŸ“„ docType:", docType);
	    
	    location.href = contextPath + `/${companyNo}/apprHome/aprvlDocDetail/${docNo}?docType=${encodedDocType}`;
	  });
	});
});
</script>